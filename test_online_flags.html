<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online.html å›½æ——åˆ‡æ¢æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .language-selector {
            position: relative;
            display: inline-block;
            margin: 20px 0;
        }
        .lang-btn {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: inherit;
            font-size: 16px;
            min-width: 120px;
        }
        .lang-btn .flag-img {
            width: 24px;
            height: 16px;
            object-fit: cover;
            border-radius: 2px;
            vertical-align: middle;
        }
        .lang-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 8px 0;
            min-width: 150px;
            display: none;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .lang-option {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background-color 0.2s;
        }
        .lang-option:hover {
            background: #f8f9fa;
        }
        .lang-option .flag-img {
            width: 20px;
            height: 14px;
            object-fit: cover;
            border-radius: 2px;
            vertical-align: middle;
        }
        .debug-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }
        .debug-info h3 {
            margin-top: 0;
            color: #007bff;
        }
        .debug-info pre {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .test-buttons {
            margin: 20px 0;
        }
        .test-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .test-btn:hover {
            background: #218838;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” Online.html å›½æ——åˆ‡æ¢åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="debug-info">
            <h3>æµ‹è¯•è¯´æ˜</h3>
            <p>è¿™ä¸ªé¡µé¢æ¨¡æ‹Ÿäº† online.html çš„å›½æ——åˆ‡æ¢åŠŸèƒ½ï¼Œç”¨äºè¯Šæ–­é—®é¢˜ã€‚</p>
        </div>
        
        <div class="language-selector">
            <button class="lang-btn" id="currentLangBtn">
                <img src="flags/en.png" alt="US Flag" class="flag-img">
                <span class="code">US</span>
            </button>
            <div class="lang-dropdown" id="langDropdown">
                <div class="lang-option" data-lang="en">
                    <img src="flags/en.png" alt="US Flag" class="flag-img">
                    <span class="code">US</span>
                </div>
                <div class="lang-option" data-lang="zh-cn">
                    <img src="flags/zh-cn.png" alt="CN Flag" class="flag-img">
                    <span class="code">CN</span>
                </div>
                <div class="lang-option" data-lang="es">
                    <img src="flags/es.png" alt="ES Flag" class="flag-img">
                    <span class="code">ES</span>
                </div>
                <div class="lang-option" data-lang="pt-br">
                    <img src="flags/pt-br.png" alt="BR Flag" class="flag-img">
                    <span class="code">BR</span>
                </div>
                <div class="lang-option" data-lang="fr">
                    <img src="flags/fr.png" alt="FR Flag" class="flag-img">
                    <span class="code">FR</span>
                </div>
                <div class="lang-option" data-lang="de">
                    <img src="flags/de.png" alt="DE Flag" class="flag-img">
                    <span class="code">DE</span>
                </div>
                <div class="lang-option" data-lang="ru">
                    <img src="flags/ru.png" alt="RU Flag" class="flag-img">
                    <span class="code">RU</span>
                </div>
                <div class="lang-option" data-lang="ar">
                    <img src="flags/ar.png" alt="SA Flag" class="flag-img">
                    <span class="code">SA</span>
                </div>
                <div class="lang-option" data-lang="hi">
                    <img src="flags/hi.png" alt="IN Flag" class="flag-img">
                    <span class="code">IN</span>
                </div>
                <div class="lang-option" data-lang="id">
                    <img src="flags/en.png" alt="ID Flag" class="flag-img">
                    <span class="code">ID</span>
                </div>
                <div class="lang-option" data-lang="vi">
                    <img src="flags/vi.png" alt="VN Flag" class="flag-img">
                    <span class="code">VN</span>
                </div>
                <div class="lang-option" data-lang="ja">
                    <img src="flags/ja.png" alt="JP Flag" class="flag-img">
                    <span class="code">JP</span>
                </div>
            </div>
        </div>
        
        <div class="test-buttons">
            <button class="test-btn" onclick="testFlagSwitching()">ğŸ§ª æµ‹è¯•å›½æ——åˆ‡æ¢</button>
            <button class="test-btn" onclick="testElementSelection()">ğŸ” æµ‹è¯•å…ƒç´ é€‰æ‹©</button>
            <button class="test-btn" onclick="testImageLoading()">ğŸ–¼ï¸ æµ‹è¯•å›¾ç‰‡åŠ è½½</button>
            <button class="test-btn" onclick="clearLog()">ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <div class="debug-info">
            <h3>è°ƒè¯•ä¿¡æ¯</h3>
            <div id="debugOutput">
                <p>ç‚¹å‡»æµ‹è¯•æŒ‰é’®å¼€å§‹è¯Šæ–­...</p>
            </div>
        </div>
        
        <div class="debug-info">
            <h3>å½“å‰çŠ¶æ€</h3>
            <p><strong>å½“å‰è¯­è¨€:</strong> <span id="currentLang">en</span></p>
            <p><strong>å½“å‰å›½æ——:</strong> <span id="currentFlag">flags/en.png</span></p>
            <p><strong>å½“å‰ä»£ç :</strong> <span id="currentCode">US</span></p>
        </div>
    </div>
    
    <script>
        // æ¨¡æ‹Ÿ online.html çš„JavaScripté€»è¾‘
        document.addEventListener('DOMContentLoaded', function() {
            const langOptions = document.querySelectorAll('.lang-option');
            const currentLangBtn = document.querySelector('#currentLangBtn');
            const langDropdown = document.querySelector('#langDropdown');
            
            log('ğŸš€ è¯­è¨€é€‰æ‹©å™¨åˆå§‹åŒ–å®Œæˆ');
            
            // ä¸ºæ¯ä¸ªè¯­è¨€é€‰é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
            langOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const lang = this.getAttribute('data-lang');
                    const flagElement = this.querySelector('.flag-img');
                    const codeElement = this.querySelector('.code');
                    
                    log(`ğŸ“ ç‚¹å‡»è¯­è¨€é€‰é¡¹: ${lang}`);
                    
                    if (flagElement && codeElement) {
                        // å¤åˆ¶å›½æ——å›¾ç‰‡åˆ°å½“å‰æŒ‰é’®
                        const currentFlagElement = currentLangBtn.querySelector('.flag-img');
                        const currentCodeElement = currentLangBtn.querySelector('.code');
                        
                        if (currentFlagElement && currentCodeElement) {
                            // å¤åˆ¶å›½æ——å›¾ç‰‡çš„srcå’Œä»£ç 
                            currentFlagElement.src = flagElement.src;
                            currentCodeElement.textContent = codeElement.textContent;
                            currentLangBtn.setAttribute('data-lang', lang);
                            
                            // æ›´æ–°æ˜¾ç¤ºçŠ¶æ€
                            updateCurrentStatus(lang, flagElement.src, codeElement.textContent);
                            
                            log(`âœ… å·²æ›´æ–°è¯­è¨€æŒ‰é’®ä¸º: ${lang}`);
                        } else {
                            log(`âŒ æœªæ‰¾åˆ°å½“å‰æŒ‰é’®çš„å…ƒç´ `, 'error');
                        }
                    } else {
                        log(`âŒ æœªæ‰¾åˆ°è¯­è¨€é€‰é¡¹çš„å…ƒç´ `, 'error');
                    }
                    
                    // éšè—ä¸‹æ‹‰èœå•
                    langDropdown.style.display = 'none';
                });
            });
            
            // ç‚¹å‡»æŒ‰é’®æ˜¾ç¤º/éšè—ä¸‹æ‹‰èœå•
            currentLangBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                const isVisible = langDropdown.style.display === 'block';
                langDropdown.style.display = isVisible ? 'none' : 'block';
                log(`ğŸ”„ åˆ‡æ¢ä¸‹æ‹‰èœå•æ˜¾ç¤º: ${!isVisible}`);
            });
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹éšè—ä¸‹æ‹‰èœå•
            document.addEventListener('click', function() {
                langDropdown.style.display = 'none';
            });
            
            // åˆå§‹åŒ–å½“å‰è¯­è¨€
            initializeLanguage();
        });
        
        function initializeLanguage() {
            log('ğŸ”§ å¼€å§‹åˆå§‹åŒ–è¯­è¨€...');
            
            const currentLangBtn = document.querySelector('#currentLangBtn');
            const currentLang = currentLangBtn.getAttribute('data-lang') || 'en';
            
            log(`ğŸŒ æ£€æµ‹åˆ°è¯­è¨€: ${currentLang}`);
            
            // æ ¹æ®å½“å‰è¯­è¨€è®¾ç½®æ­£ç¡®çš„å›½æ——å’Œä»£ç 
            const targetOption = document.querySelector(`.lang-option[data-lang="${currentLang}"]`);
            if (targetOption) {
                const flagElement = targetOption.querySelector('.flag-img');
                const codeElement = targetOption.querySelector('.code');
                const currentFlagElement = currentLangBtn.querySelector('.flag-img');
                const currentCodeElement = currentLangBtn.querySelector('.code');
                
                if (flagElement && codeElement && currentFlagElement && currentCodeElement) {
                    currentFlagElement.src = flagElement.src;
                    currentCodeElement.textContent = codeElement.textContent;
                    updateCurrentStatus(currentLang, flagElement.src, codeElement.textContent);
                    log(`âœ… å·²è®¾ç½®å›½æ——å’Œä»£ç : ${currentLang}`);
                } else {
                    log(`âŒ å…ƒç´ æœªæ‰¾åˆ°ï¼Œç­‰å¾…DOMåŠ è½½...`, 'error');
                }
            } else {
                log(`âŒ æœªæ‰¾åˆ°è¯­è¨€é€‰é¡¹: ${currentLang}`, 'error');
            }
        }
        
        function updateCurrentStatus(lang, flagSrc, code) {
            document.getElementById('currentLang').textContent = lang;
            document.getElementById('currentFlag').textContent = flagSrc;
            document.getElementById('currentCode').textContent = code;
        }
        
        function testFlagSwitching() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•å›½æ——åˆ‡æ¢åŠŸèƒ½...');
            
            // æµ‹è¯•åˆ‡æ¢åˆ°ä¸­æ–‡
            const zhOption = document.querySelector('.lang-option[data-lang="zh-cn"]');
            if (zhOption) {
                zhOption.click();
                log('âœ… æµ‹è¯•åˆ‡æ¢åˆ°ä¸­æ–‡å®Œæˆ');
            } else {
                log('âŒ æœªæ‰¾åˆ°ä¸­æ–‡é€‰é¡¹', 'error');
            }
        }
        
        function testElementSelection() {
            log('ğŸ” å¼€å§‹æµ‹è¯•å…ƒç´ é€‰æ‹©...');
            
            const elements = {
                'å½“å‰æŒ‰é’®': document.querySelector('#currentLangBtn'),
                'å›½æ——å›¾ç‰‡': document.querySelector('#currentLangBtn .flag-img'),
                'è¯­è¨€ä»£ç ': document.querySelector('#currentLangBtn .code'),
                'ä¸‹æ‹‰èœå•': document.querySelector('#langDropdown'),
                'è¯­è¨€é€‰é¡¹æ•°é‡': document.querySelectorAll('.lang-option').length
            };
            
            Object.entries(elements).forEach(([name, element]) => {
                if (element) {
                    log(`âœ… ${name}: æ‰¾åˆ°`);
                } else {
                    log(`âŒ ${name}: æœªæ‰¾åˆ°`, 'error');
                }
            });
        }
        
        function testImageLoading() {
            log('ğŸ–¼ï¸ å¼€å§‹æµ‹è¯•å›¾ç‰‡åŠ è½½...');
            
            const images = document.querySelectorAll('.flag-img');
            let loadedCount = 0;
            let totalCount = images.length;
            
            images.forEach((img, index) => {
                if (img.complete) {
                    loadedCount++;
                    log(`âœ… å›¾ç‰‡ ${index + 1}: å·²åŠ è½½ (${img.src})`);
                } else {
                    log(`â³ å›¾ç‰‡ ${index + 1}: åŠ è½½ä¸­ (${img.src})`);
                    img.addEventListener('load', () => {
                        loadedCount++;
                        log(`âœ… å›¾ç‰‡ ${index + 1}: åŠ è½½å®Œæˆ (${img.src})`);
                    });
                    img.addEventListener('error', () => {
                        log(`âŒ å›¾ç‰‡ ${index + 1}: åŠ è½½å¤±è´¥ (${img.src})`, 'error');
                    });
                }
            });
            
            if (loadedCount === totalCount) {
                log(`ğŸ‰ æ‰€æœ‰å›¾ç‰‡å·²åŠ è½½å®Œæˆ (${loadedCount}/${totalCount})`);
            } else {
                log(`â³ å›¾ç‰‡åŠ è½½è¿›åº¦: ${loadedCount}/${totalCount}`);
            }
        }
        
        function log(message, type = 'info') {
            const debugOutput = document.getElementById('debugOutput');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            
            const logEntry = document.createElement('p');
            logEntry.className = className;
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            
            debugOutput.appendChild(logEntry);
            debugOutput.scrollTop = debugOutput.scrollHeight;
            
            console.log(`[${timestamp}] ${message}`);
        }
        
        function clearLog() {
            document.getElementById('debugOutput').innerHTML = '<p>æ—¥å¿—å·²æ¸…ç©º...</p>';
        }
    </script>
</body>
</html> 